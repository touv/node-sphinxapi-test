#!/bin/bash 

FILE_FORWARD=ll/.forward
TMP_FILE=`tempfile -d ll/tmp`

case ${1} in
    --uninstall)
        if [ -f "$FILE_FORWARD" ]; then
            grep -v "thouveni@thouveni2" $FILE_FORWARD > $TMP_FILE
            if [ "`diff $TMP_FILE $FILE_FORWARD`" != "" ]; then
                cp -f $TMP_FILE $FILE_FORWARD
                echo "thouveni@thouveni2 removed from $FILE_FORWARD"
            else
                echo "thouveni@thouveni2 not found in $FILE_FORWARD"
                exit 0
            fi
            rm -f $TMP_FILE
        else
            echo "$FILE_FORWARD doesn't exist"
            exit 1
        fi
    ;;

    --install|*)
        NOT_INSTALLED=`grep "thouveni@thouveni2" $FILE_FORWARD 2&>/dev/null`
        if [ "$NOT_INSTALLED" == "" ]; then
            echo "thouveni@thouveni2" >> $FILE_FORWARD
            echo "thouveni@thouveni2 added to $FILE_FORWARD"
        else
            echo "thouveni@thouveni2 already in $FILE_FORWARD"
            exit 0
        fi
    ;;
esac

exit 0